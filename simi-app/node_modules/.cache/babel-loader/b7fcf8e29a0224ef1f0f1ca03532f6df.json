{"ast":null,"code":"import { signInWithPopup, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail, signOut } from \"firebase/auth\";\nimport { query, getDocs, collection, where, addDoc } from \"firebase/firestore\";\nimport { auth, db, googleProvider } from \"../utils/firebase\";\n\nconst signInWithGoogle = async () => {\n  try {\n    const res = await signInWithPopup(auth, googleProvider);\n    const user = res.user;\n    const q = query(collection(db, \"users\"), where(\"id\", \"==\", user.id));\n    const docs = await getDocs(q);\n\n    if (docs.docs.length === 0) {\n      await addDoc(collection(db, \"users\"), {\n        id: user.id,\n        name: user.displayName,\n        authProvider: \"google\",\n        email: user.email\n      });\n    }\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst logInWithEmailAndPassword = async (email, password) => {\n  try {\n    await signInWithEmailAndPassword(auth, email, password);\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst registerWithEmailAndPassword = async value => {\n  const {\n    displayName,\n    email,\n    password\n  } = value;\n\n  try {\n    const res = await createUserWithEmailAndPassword(auth, email, password);\n    const user = res.user;\n    await addDoc(collection(db, \"users\"), {\n      uid: user.uid,\n      displayName,\n      authProvider: \"local\",\n      email\n    });\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst sendPasswordReset = async email => {\n  try {\n    await sendPasswordResetEmail(auth, email);\n    alert(\"Password reset link sent!\");\n  } catch (err) {\n    console.error(err);\n    alert(err.message);\n  }\n};\n\nconst logout = () => {\n  signOut(auth);\n};\n\nexport { signInWithGoogle, logInWithEmailAndPassword, registerWithEmailAndPassword, sendPasswordReset, logout };","map":{"version":3,"names":["signInWithPopup","signInWithEmailAndPassword","createUserWithEmailAndPassword","sendPasswordResetEmail","signOut","query","getDocs","collection","where","addDoc","auth","db","googleProvider","signInWithGoogle","res","user","q","id","docs","length","name","displayName","authProvider","email","err","console","error","alert","message","logInWithEmailAndPassword","password","registerWithEmailAndPassword","value","uid","sendPasswordReset","logout"],"sources":["/Users/macbook/Development/SIMI/simi-app/src/services/auth.js"],"sourcesContent":["import {\n    signInWithPopup,\n    signInWithEmailAndPassword,\n    createUserWithEmailAndPassword,\n    sendPasswordResetEmail,\n    signOut,\n} from \"firebase/auth\";\nimport { query, getDocs, collection, where, addDoc } from \"firebase/firestore\";\nimport { auth, db, googleProvider } from \"../utils/firebase\";\n\nconst signInWithGoogle = async () => {\n    try {\n        const res = await signInWithPopup(auth, googleProvider);\n        const user = res.user;\n        const q = query(collection(db, \"users\"), where(\"id\", \"==\", user.id));\n        const docs = await getDocs(q);\n        if (docs.docs.length === 0) {\n            await addDoc(collection(db, \"users\"), {\n                id: user.id,\n                name: user.displayName,\n                authProvider: \"google\",\n                email: user.email,\n            });\n        }\n    } catch (err) {\n        console.error(err);\n        alert(err.message);\n    }\n};\n\nconst logInWithEmailAndPassword = async (email, password) => {\n    try {\n        await signInWithEmailAndPassword(auth, email, password);\n    } catch (err) {\n        console.error(err);\n        alert(err.message);\n    }\n};\n\nconst registerWithEmailAndPassword = async (value) => {\n    const { displayName, email, password } = value\n    try {\n        const res = await createUserWithEmailAndPassword(auth, email, password);\n        const user = res.user;\n        await addDoc(collection(db, \"users\"), {\n            uid: user.uid,\n            displayName,\n            authProvider: \"local\",\n            email,\n        });\n    } catch (err) {\n        console.error(err);\n        alert(err.message);\n    }\n};\n\nconst sendPasswordReset = async (email) => {\n    try {\n        await sendPasswordResetEmail(auth, email);\n        alert(\"Password reset link sent!\");\n    } catch (err) {\n        console.error(err);\n        alert(err.message);\n    }\n};\n\nconst logout = () => {\n    signOut(auth);\n};\n\nexport {\n    signInWithGoogle,\n    logInWithEmailAndPassword,\n    registerWithEmailAndPassword,\n    sendPasswordReset,\n    logout,\n};"],"mappings":"AAAA,SACIA,eADJ,EAEIC,0BAFJ,EAGIC,8BAHJ,EAIIC,sBAJJ,EAKIC,OALJ,QAMO,eANP;AAOA,SAASC,KAAT,EAAgBC,OAAhB,EAAyBC,UAAzB,EAAqCC,KAArC,EAA4CC,MAA5C,QAA0D,oBAA1D;AACA,SAASC,IAAT,EAAeC,EAAf,EAAmBC,cAAnB,QAAyC,mBAAzC;;AAEA,MAAMC,gBAAgB,GAAG,YAAY;EACjC,IAAI;IACA,MAAMC,GAAG,GAAG,MAAMd,eAAe,CAACU,IAAD,EAAOE,cAAP,CAAjC;IACA,MAAMG,IAAI,GAAGD,GAAG,CAACC,IAAjB;IACA,MAAMC,CAAC,GAAGX,KAAK,CAACE,UAAU,CAACI,EAAD,EAAK,OAAL,CAAX,EAA0BH,KAAK,CAAC,IAAD,EAAO,IAAP,EAAaO,IAAI,CAACE,EAAlB,CAA/B,CAAf;IACA,MAAMC,IAAI,GAAG,MAAMZ,OAAO,CAACU,CAAD,CAA1B;;IACA,IAAIE,IAAI,CAACA,IAAL,CAAUC,MAAV,KAAqB,CAAzB,EAA4B;MACxB,MAAMV,MAAM,CAACF,UAAU,CAACI,EAAD,EAAK,OAAL,CAAX,EAA0B;QAClCM,EAAE,EAAEF,IAAI,CAACE,EADyB;QAElCG,IAAI,EAAEL,IAAI,CAACM,WAFuB;QAGlCC,YAAY,EAAE,QAHoB;QAIlCC,KAAK,EAAER,IAAI,CAACQ;MAJsB,CAA1B,CAAZ;IAMH;EACJ,CAbD,CAaE,OAAOC,GAAP,EAAY;IACVC,OAAO,CAACC,KAAR,CAAcF,GAAd;IACAG,KAAK,CAACH,GAAG,CAACI,OAAL,CAAL;EACH;AACJ,CAlBD;;AAoBA,MAAMC,yBAAyB,GAAG,OAAON,KAAP,EAAcO,QAAd,KAA2B;EACzD,IAAI;IACA,MAAM7B,0BAA0B,CAACS,IAAD,EAAOa,KAAP,EAAcO,QAAd,CAAhC;EACH,CAFD,CAEE,OAAON,GAAP,EAAY;IACVC,OAAO,CAACC,KAAR,CAAcF,GAAd;IACAG,KAAK,CAACH,GAAG,CAACI,OAAL,CAAL;EACH;AACJ,CAPD;;AASA,MAAMG,4BAA4B,GAAG,MAAOC,KAAP,IAAiB;EAClD,MAAM;IAAEX,WAAF;IAAeE,KAAf;IAAsBO;EAAtB,IAAmCE,KAAzC;;EACA,IAAI;IACA,MAAMlB,GAAG,GAAG,MAAMZ,8BAA8B,CAACQ,IAAD,EAAOa,KAAP,EAAcO,QAAd,CAAhD;IACA,MAAMf,IAAI,GAAGD,GAAG,CAACC,IAAjB;IACA,MAAMN,MAAM,CAACF,UAAU,CAACI,EAAD,EAAK,OAAL,CAAX,EAA0B;MAClCsB,GAAG,EAAElB,IAAI,CAACkB,GADwB;MAElCZ,WAFkC;MAGlCC,YAAY,EAAE,OAHoB;MAIlCC;IAJkC,CAA1B,CAAZ;EAMH,CATD,CASE,OAAOC,GAAP,EAAY;IACVC,OAAO,CAACC,KAAR,CAAcF,GAAd;IACAG,KAAK,CAACH,GAAG,CAACI,OAAL,CAAL;EACH;AACJ,CAfD;;AAiBA,MAAMM,iBAAiB,GAAG,MAAOX,KAAP,IAAiB;EACvC,IAAI;IACA,MAAMpB,sBAAsB,CAACO,IAAD,EAAOa,KAAP,CAA5B;IACAI,KAAK,CAAC,2BAAD,CAAL;EACH,CAHD,CAGE,OAAOH,GAAP,EAAY;IACVC,OAAO,CAACC,KAAR,CAAcF,GAAd;IACAG,KAAK,CAACH,GAAG,CAACI,OAAL,CAAL;EACH;AACJ,CARD;;AAUA,MAAMO,MAAM,GAAG,MAAM;EACjB/B,OAAO,CAACM,IAAD,CAAP;AACH,CAFD;;AAIA,SACIG,gBADJ,EAEIgB,yBAFJ,EAGIE,4BAHJ,EAIIG,iBAJJ,EAKIC,MALJ"},"metadata":{},"sourceType":"module"}